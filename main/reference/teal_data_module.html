<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Create a teal_data_module object and evaluate code on it with history tracking."><title>Data module for teal applications — teal_data_module • teal</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data module for teal applications — teal_data_module"><meta property="og:description" content="
Create a teal_data_module object and evaluate code on it with history tracking."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="../consent.css"><script src="../consent.js" type="text/javascript" charset="utf-8"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">teal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.2.9027</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/getting-started-with-teal.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Get started</h6>
    <a class="dropdown-item" href="../articles/getting-started-with-teal.html">Getting Started with teal</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Using `teal`</h6>
    <a class="dropdown-item" href="../articles/filter-panel.html">Filter Panel</a>
    <a class="dropdown-item" href="../articles/teal-options.html">Modifying a teal Application With R Options</a>
    <a class="dropdown-item" href="../articles/bootstrap-themes-in-teal.html">Bootstrap Themes in teal</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Data in `teal` apps</h6>
    <a class="dropdown-item" href="../articles/including-data-in-teal-applications.html">Including Data in teal Applications</a>
    <a class="dropdown-item" href="../articles/data-as-shiny-module.html">Data as shiny Module</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Extending `teal`</h6>
    <a class="dropdown-item" href="../articles/creating-custom-modules.html">Creating Custom Modules</a>
    <a class="dropdown-item" href="../articles/adding-support-for-reporting.html">Adding Support for Reporting to Custom Modules</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-technical-blueprint">Technical blueprint</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-technical-blueprint">
    <a class="dropdown-item" href="../articles/blueprint/index.html">About blueprint</a>
    <a class="dropdown-item" href="../articles/blueprint/intro.html">Introduction</a>
    <a class="dropdown-item" href="../articles/blueprint/actors.html">Actors</a>
    <a class="dropdown-item" href="../articles/blueprint/dataflow.html">Data flow</a>
    <a class="dropdown-item" href="../articles/blueprint/product_map.html">Product map</a>
    <h6 class="dropdown-header" data-toc-skip>Features</h6>
    <a class="dropdown-item" href="../articles/blueprint/input_data.html">Input data</a>
    <a class="dropdown-item" href="../articles/blueprint/in_app_data.html">In-app data</a>
    <a class="dropdown-item" href="../articles/blueprint/filter_panel.html">Filter panel</a>
    <a class="dropdown-item" href="../articles/blueprint/module_encapsulation.html">Module and encapsulation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/teal">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Data module for <code>teal</code> applications</h1>
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/teal/blob/HEAD/R/teal_data_module.R" class="external-link"><code>R/teal_data_module.R</code></a>, <a href="https://github.com/insightsengineering/teal/blob/HEAD/R/teal_data_module-eval_code.R" class="external-link"><code>R/teal_data_module-eval_code.R</code></a>, <a href="https://github.com/insightsengineering/teal/blob/HEAD/R/teal_data_module-within.R" class="external-link"><code>R/teal_data_module-within.R</code></a></small>
      <div class="d-none name"><code>teal_data_module.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Create a <code>teal_data_module</code> object and evaluate code on it with history tracking.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">teal_data_module</span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for teal_data_module,character</span></span>
<span><span class="fu">eval_code</span><span class="op">(</span><span class="va">object</span>, <span class="va">code</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for teal_data_module</span></span>
<span><span class="fu">within</span><span class="op">(</span><span class="va">data</span>, <span class="va">expr</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ui</dt>
<dd><p>(<code>function(id)</code>)
<code>shiny</code> module UI function; must only take <code>id</code> argument</p></dd>


<dt>server</dt>
<dd><p>(<code>function(id)</code>)
<code>shiny</code> module server function; must only take <code>id</code> argument;
must return reactive expression containing <code>teal_data</code> object</p></dd>


<dt>object</dt>
<dd><p>(<code>teal_data_module</code>)</p></dd>


<dt>code</dt>
<dd><p>(<code>character</code> or <code>language</code>) code to evaluate. If <code>character</code>, comments are retained.</p></dd>


<dt>data</dt>
<dd><p>(<code>teal_data_module</code>) object</p></dd>


<dt>expr</dt>
<dd><p>(<code>expression</code>) to evaluate. Must be inline code. See</p></dd>


<dt>...</dt>
<dd><p>See <code>Details</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>teal_data_module</code> returns an object of class <code>teal_data_module</code>.</p>


<p><code>eval_code</code> returns a <code>teal_data_module</code> object with a delayed evaluation of <code>code</code> when the module is run.</p>


<p><code>within</code> returns a <code>teal_data_module</code> object with a delayed evaluation of <code>expr</code> when the module is run.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>teal_data_module</code> creates a <code>shiny</code> module to supply or modify data in a <code>teal</code> application.
The module allows for running data pre-processing code (creation <em>and</em> some modification) after the app starts.
The body of the server function will be run in the app rather than in the global environment.
This means it will be run every time the app starts, so use sparingly.</p>
<p>Pass this module instead of a <code>teal_data</code> object in a call to <code><a href="init.html">init()</a></code>.
Note that the server function must always return a <code>teal_data</code> object wrapped in a reactive expression.</p>
<p>See vignette <code><a href="../articles/data-as-shiny-module.html">vignette("data-as-shiny-module", package = "teal")</a></code> for more details.</p>
<p><code>eval_code</code> evaluates given code in the environment of the <code>teal_data</code> object created by the <code>teal_data_module</code>.
The code is added to the <code>@code</code> slot of the <code>teal_data</code>.</p>
<p><code>within</code> is a convenience function for evaluating inline code inside the environment of a <code>teal_data_module</code>.
It accepts only inline expressions (both simple and compound) and allows for injecting values into <code>expr</code> through
the <code>...</code> argument: as <code>name:value</code> pairs are passed to <code>...</code>, <code>name</code> in <code>expr</code> will be replaced with <code>value.</code></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://insightsengineering.github.io/teal.data/latest-tag/reference/teal_data-class.html">teal.data::teal_data</a></code>, <code><a href="https://insightsengineering.github.io/teal.code/latest-tag/reference/qenv.html">teal.code::qenv()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tdm</span> <span class="op">&lt;-</span> <span class="fu">teal_data_module</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"submit"</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"Load data"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span>,</span></span>
<span class="r-in"><span>  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html" class="external-link">moduleServer</a></span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">eventReactive</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">submit</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">within</span><span class="op">(</span></span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://insightsengineering.github.io/teal.data/latest-tag/reference/teal_data.html">teal_data</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="va">iris</span></span></span>
<span class="r-in"><span>            <span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span></span>
<span class="r-in"><span>          <span class="op">}</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://insightsengineering.github.io/teal.data/latest-tag/reference/datanames.html">datanames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dataset1"</span>, <span class="st">"dataset2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>        <span class="va">data</span></span></span>
<span class="r-in"><span>      <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">eval_code</span><span class="op">(</span><span class="va">tdm</span>, <span class="st">"dataset1 &lt;- subset(dataset1, Species == 'virginica')"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ui</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ns &lt;- NS(id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       object$ui(ns("mutate_inner"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x555e0fb314f0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $server</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       moduleServer(id, function(input, output, session) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         teal_data_rv &lt;- object$server("mutate_inner")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (!is.reactive(teal_data_rv)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           stop("The `teal_data_module` must return a reactive expression.", call. = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         td &lt;- eventReactive(teal_data_rv(),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             if (inherits(teal_data_rv(), c("teal_data", "qenv.error"))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               eval_code(teal_data_rv(), code)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               teal_data_rv()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           },</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ignoreNULL = FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         td</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x555e0fb314f0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "teal_data_module"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">within</span><span class="op">(</span><span class="va">tdm</span>, <span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">Species</span> <span class="op">==</span> <span class="st">"virginica"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ui</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ns &lt;- NS(id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       object$ui(ns("mutate_inner"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x555e0fa7fca0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $server</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       moduleServer(id, function(input, output, session) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         teal_data_rv &lt;- object$server("mutate_inner")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (!is.reactive(teal_data_rv)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           stop("The `teal_data_module` must return a reactive expression.", call. = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         td &lt;- eventReactive(teal_data_rv(),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             if (inherits(teal_data_rv(), c("teal_data", "qenv.error"))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               eval_code(teal_data_rv(), code)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               teal_data_rv()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           },</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ignoreNULL = FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         td</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x555e0fa7fca0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "teal_data_module"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use additional parameter for expression value substitution.</span></span></span>
<span class="r-in"><span><span class="va">valid_species</span> <span class="op">&lt;-</span> <span class="st">"versicolor"</span></span></span>
<span class="r-in"><span><span class="fu">within</span><span class="op">(</span><span class="va">tdm</span>, <span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">Species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">species</span><span class="op">)</span>, species <span class="op">=</span> <span class="va">valid_species</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ui</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ns &lt;- NS(id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       object$ui(ns("mutate_inner"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x555e0f8c6ba0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $server</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       moduleServer(id, function(input, output, session) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         teal_data_rv &lt;- object$server("mutate_inner")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (!is.reactive(teal_data_rv)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           stop("The `teal_data_module` must return a reactive expression.", call. = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         td &lt;- eventReactive(teal_data_rv(),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             if (inherits(teal_data_rv(), c("teal_data", "qenv.error"))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               eval_code(teal_data_rv(), code)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               teal_data_rv()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           },</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ignoreNULL = FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         td</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x555e0f8c6ba0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "teal_data_module"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="nest">
  <p>teal is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../analytics.js"></script></footer></div>

  

  

  </body></html>

