<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data as shiny Module â€¢ teal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data as shiny Module">
<link rel="stylesheet" href="../consent.css">
<script src="../consent.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">teal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9001</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/getting-started-with-teal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Get started</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started-with-teal.html">Getting Started with teal</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data in `teal` apps</h6></li>
    <li><a class="dropdown-item" href="../articles/including-data-in-teal-applications.html">Including Data in teal Applications</a></li>
    <li><a class="dropdown-item" href="../articles/data-as-shiny-module.html">Data as shiny Module</a></li>
    <li><a class="dropdown-item" href="../articles/filter-panel.html">Filter Panel</a></li>
    <li><a class="dropdown-item" href="../articles/transform-input-data.html">Transform Input Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending `teal`</h6></li>
    <li><a class="dropdown-item" href="../articles/creating-custom-modules.html">Creating Custom Modules</a></li>
    <li><a class="dropdown-item" href="../articles/adding-support-for-reporting.html">Adding Support for Reporting to Custom Modules</a></li>
    <li><a class="dropdown-item" href="../articles/transform-module-output.html">Transform Module Output</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Using `teal`</h6></li>
    <li><a class="dropdown-item" href="../articles/teal-as-a-shiny-module.html">Teal as a Shiny Module</a></li>
    <li><a class="dropdown-item" href="../articles/teal-options.html">Modifying a teal Application With R Options</a></li>
    <li><a class="dropdown-item" href="../articles/bootstrap-themes-in-teal.html">Bootstrap Themes in teal</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-technical-blueprint" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Technical blueprint</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-technical-blueprint">
<li><a class="dropdown-item" href="../articles/blueprint/index.html">About blueprint</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint/intro.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint/actors.html">Actors</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint/dataflow.html">Data flow</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint/product_map.html">Product map</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Features</h6></li>
    <li><a class="dropdown-item" href="../articles/blueprint/input_data.html">Input data</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint/in_app_data.html">In-app data</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint/filter_panel.html">Filter panel</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint/module_encapsulation.html">Module and encapsulation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports">
<li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report-non-cran/">Non-CRAN unit test report</a></li>
  </ul>
</li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v1.0.0">v1.0.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v1.0.0-rc1">v1.0.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.16.0">v0.16.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.16.0-rc2">v0.16.0-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.16.0-rc1">v0.16.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.15.2">v0.15.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.15.2-rc1">v0.15.2-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.15.1">v0.15.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.15.1-rc1">v0.15.1-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.15.0">v0.15.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.15.0-rc1">v0.15.0-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.14.0">v0.14.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.13.0">v0.13.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/teal/v0.12.0">v0.12.0</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/insightsengineering/teal" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Data as shiny Module</h1>
                        <h4 data-toc-skip class="author">NEST
CoreDev</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/teal/blob/main/vignettes/data-as-shiny-module.Rmd" class="external-link"><code>vignettes/data-as-shiny-module.Rmd</code></a></small>
      <div class="d-none name"><code>data-as-shiny-module.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Proper functioning of any <code>teal</code> application requires the
presence of a <code>teal_data</code> object. Typically, a
<code>teal_data</code> object created in the global environment will be
passed to the <code>data</code> argument in <code>init</code>. This
<code>teal_data</code> object should contain all elements necessary for
successful execution of the applicationâ€™s modules.</p>
<p>In some scenarios, however, application developers may opt to
postpone some data operations until the application runtime. This can be
done by passing a special <em><code>shiny</code> module</em> to the
<code>data</code> argument. The <code>teal_data_module</code> function
is used to build such a module from the following components:</p>
<ul>
<li>a UI function; accepts only one argument, <code>id</code>; defines
user interface elements for the data module</li>
<li>a server function: accepts only one argument, <code>id</code>;
defines server logic for the data module, including data creation; must
return a reactive expression containing a <code>teal_data</code>
object</li>
</ul>
<p><code>teal</code> will run this module when the application starts
and the resulting <code>teal_data</code> object that will be used
throughout all <code>teal</code> (analytic) modules.</p>
</div>
<div class="section level2">
<h2 id="creating-data-in-app">Creating data in-app<a class="anchor" aria-label="anchor" href="#creating-data-in-app"></a>
</h2>
<p>One case for postponing data operations is datasets that are dynamic,
frequently updated. Such data cannot be created once and kept in the
global environment. Using <code>teal_data_module</code> enables creating
a dataset from scratch every time the user starts the application.</p>
<p><em>See <code>?qenv</code> for a detailed explanation of how to use
the <code>within</code> method.</em></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/teal/">teal</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_module</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/teal_data_module.html">teal_data_module</a></span><span class="op">(</span></span>
<span>  ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html" class="external-link">moduleServer</a></span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/teal_data_module.html">within</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://insightsengineering.github.io/teal.data/latest-tag/reference/teal_data.html">teal_data</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          <span class="op">{</span></span>
<span>            <span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span>            <span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">data</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_module</span>,</span>
<span>  modules <span class="op">=</span> <span class="fu"><a href="../reference/example_module.html">example_module</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">$</span><span class="va">ui</span>, <span class="va">app</span><span class="op">$</span><span class="va">server</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<iframe src="https://shinylive.io/r/app/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMASzLgCcoDTqA3OAAgB4BaDgMwCuEZtRIAKAJQcAKlgCqAUQA6EADbUARo3oBPceShrJq1QBMopKAH0YRM4LWdeHQ2usWrt+47jjVHByC1BwAvALCohLUZtJWAOYAzgAkZmxSuAEciQzs9GERIizRsRwgWYF2Dk4AyrkM4jG4hVEQjRCogqTNRF2d3dlwiYliENLlEIFTHPRwTCzs4hPT055Q3HwA7tSkABa0-pMr024ellAZFcdlV9ccazmkAIwbHNT01Im31w9wpABMrxgpAIUHoXyOdwAvt9AiZISs1t8ofDpiisjCxqYIKo0KhXrQdodAmsCmtvNU4JkjlVfIkCnAAB6wVBOCm+KSqeGqaj8DjtciMUSLSTjLKJfYQXQAQXQ4jxyWCzQVOXoeXhULAUIAukA" width="150%" height="800px" data-external="1" style="position: relative; z-index:1">
</iframe>
</div>
<div class="section level2">
<h2 id="modification-of-data-in-app">Modification of data in-app<a class="anchor" aria-label="anchor" href="#modification-of-data-in-app"></a>
</h2>
<p>Another reason to postpone data operations is to involve the
application user in the preprocessing stage. An initial, constant form
of the data can be created in the global environment and then modified
once the app starts.</p>
<p>The following example illustrates how <code>teal_data_module</code>
can be utilized to subset data based on the user inputs:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/teal_data_module.html">within</a></span><span class="op">(</span><span class="fu"><a href="https://insightsengineering.github.io/teal.data/latest-tag/reference/teal_data.html">teal_data</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">{</span></span>
<span>  <span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span>  <span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_module</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/teal_data_module.html">teal_data_module</a></span><span class="op">(</span></span>
<span>  ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"species"</span><span class="op">)</span>, <span class="st">"Select species to keep"</span>,</span>
<span>        choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, multiple <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"submit"</span><span class="op">)</span>, <span class="st">"Submit"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html" class="external-link">moduleServer</a></span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">eventReactive</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">submit</span>, <span class="op">{</span></span>
<span>        <span class="va">data_modified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/teal_data_module.html">within</a></span><span class="op">(</span></span>
<span>          <span class="va">data</span>,</span>
<span>          <span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">Species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">selected</span><span class="op">)</span>,</span>
<span>          selected <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">species</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">data_modified</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_module</span>,</span>
<span>  modules <span class="op">=</span> <span class="fu"><a href="../reference/example_module.html">example_module</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">app</span><span class="op">$</span><span class="va">ui</span>, server <span class="op">=</span> <span class="va">app</span><span class="op">$</span><span class="va">server</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<iframe src="https://shinylive.io/r/app/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMASzLgCcoDTqA3OAAgB4BaDgMwCuEZtRIAKAJQcAKlgCqAUQA6EADbUARo3oBPceShrJqgCZRSUbnwDu1UgAtaBuEYD65y1NwcQqjhyeUADOcKQAjNYc1PTUwf6BFiFhAExRMKQEUPTxEAC+JhBmSW4wRKaCapy8HIZqHiVlFVXiCYLUHAC8AsKiEtSm0n4QAQEQwVEAcgDK4gOFo7VQAObBACSmbK0jixyhVcwAkhCogqTi461gwahwBNRw8WCSPspg03AHpHu394+1RA4AGs4HBUG9cAldhwCA4iNQCP9usJqABHQRwOaxdbTX4PYIvDgwSosVBVLqyBQqHaLF5Q0ZMFgkABCZ1IEkub2Cgk0MHsb0Jb2mPL5pAF9IWHDykJ2oXo7HoFKEIiZEDmg189KalTgH3lDHVPmVfTVtFOpB8RDO5p8oWCwTEECG9ICcHYZCwrlE7DmJzOa25vPsPmG0ICQVK5Wo-AepiidkczhduyCMrDoyCoQiUUDWfEmbC4R8uLu+I4AFJaOW9p87uRBmn0zWvnA490zf6bqXHsmApLoRGmtHY8mCvSxzs8qpCqo0KgorR7Ntw0kKYPyjrG9qqhNunAAB6wMlwSPNTGFGcQaMcX3kRje8-O2VOCC6RCIYIv3QAQXQ4naFJzms7S2gwCqAegAZgQwhR5GAeQALpAA" width="150%" height="800px" data-external="1" style="position: relative; z-index:1">
</iframe>
<p>Note that running preprocessing code in a module as opposed to the
global environment will increase app loading times. It is recommended to
keep the constant code in the global environment and to move only the
dynamic parts to a data module.</p>
<div class="section level6">
<h6 id="warning">WARNING<a class="anchor" aria-label="anchor" href="#warning"></a>
</h6>
<p>When using <code>teal_data_module</code> to modify a pre-existing
<code>teal_data</code> object, it is crucial that the server function
and the data object are defined in the same environment, otherwise the
server function will not be able to access the data object. This means
server functions defined in packages cannot be used.</p>
</div>
<div class="section level3">
<h3 id="extending-existing-teal_data_modules">Extending existing <code>teal_data_modules</code><a class="anchor" aria-label="anchor" href="#extending-existing-teal_data_modules"></a>
</h3>
<p>The server logic of a <code>teal_data_module</code> can be modified
before it is used in an app, using the <code>within</code> function.
This allows the <code>teal_data</code> object that is created in the
<code>teal_data_module</code> to be processed further.</p>
<p>In the previous example, <code>data_module</code> takes a predefined
<code>teal_data</code> object and allows the app user to select a
subset. The following example modifies <code>data_module</code> so that
new columns are added once the data is retrieved.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_module_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/teal_data_module.html">within</a></span><span class="op">(</span></span>
<span>  <span class="va">data_module</span>,</span>
<span>  <span class="op">{</span></span>
<span>    <span class="co"># Create new column with Ratio of Sepal.Width and Petal.Width</span></span>
<span>    <span class="va">dataset1</span><span class="op">$</span><span class="va">Ratio.Sepal.Petal.Width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dataset1</span><span class="op">$</span><span class="va">Sepal.Width</span> <span class="op">/</span> <span class="va">dataset1</span><span class="op">$</span><span class="va">Petal.Width</span>, digits <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span>    <span class="co"># Create new column that converts Miles per Galon to Liter per 100 Km</span></span>
<span>    <span class="va">dataset2</span><span class="op">$</span><span class="va">lp100km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dataset2</span><span class="op">$</span><span class="va">mpg</span> <span class="op">*</span> <span class="fl">0.42514371</span>, digits <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_module_2</span>,</span>
<span>  modules <span class="op">=</span> <span class="fu"><a href="../reference/example_module.html">example_module</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">app</span><span class="op">$</span><span class="va">ui</span>, server <span class="op">=</span> <span class="va">app</span><span class="op">$</span><span class="va">server</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<iframe src="https://shinylive.io/r/app/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMASzLgCcoDTqA3OAAgB4BaDgMwCuEZtRIAKAJQcAKlgCqAUQA6EADbUARo3oBPceShrJq1QBMopKNz4B3aqQAWtA3CMB9C1am4OIVRwcXlAAznCkAIw2HNT01CEBQZah4QBM0TCkBFD0CRAAviYQ5snuMERmgmqcvByGap6l5ZXV4omC1BwAvALCohLUZtL+EIGBECHRAHIAyuKDRWN1UADmIQAkZmxto0scYdXMAJIQqIKk4hNtYCGocATUcAlgkr7KYDNwh6T7dw9PdSIHAA1nA4Kh3rhEnsOARHERqAQAT1hNQAI6CODzOIbGZ-R4hV4cGBVFioardWQKFS7JavaFjJgsEgAIXOpAkV3eIUEmhgDneRPeM15-NIgoZiw4+ShuzC9HY9EpQhEzIg8yGfgZzSqcE+CoYGt8Kv66toZ1IviI5wtvjCIRCYggwwZgTg7DIWDconY81O53WPL5Dl8IxhgWCZQq1H4jzM0XsThcrr2wVl4bGwTCkWiQez4iz4Qivjx9wJHAApLQK-svvdyEN0xna984PGeuaA7cy08U4EpTDI80Y3GU4UGePdvlVEUhxVde50rVE851Yk5y04E2w2MAMQcADC9Dc5A4EDgtlhRDUghgoxXHCwljEHCI-A4n1QRgwAHVBk4OCgCB4wABXCb8-zMJwGULSJ1ifZkME-b8wKsNRf3-Rxonoa1gILZJswidZkPQyCAIAeiSKxCPWVCIMw3wthWBxJh6VIABkBw4fcjxPThz0vYgbzvOpHEsK8IEVUhJgAWWoapJjuJUAHEjBIQEOHYhwGA4JSOAiAAGAyOAAaRgGCCLSdY1FQQyDOBGBsNwsx8OoqyYFQFYOAAKg4AyMAAFlSABWCIAoAZgAdmLIJqGY6TKQ4qVp2dUxoHQaJaAcHYI2SSkNwXVImx1BTKTgAAPWByTgKNNykGc0pjDg-XIRgfSxSQXTlVddEQRAQh6gBBdBxA6Sk0FQdYOjtBhFXG9BA1mhginyMB8gAXSAA" width="150%" height="800px" data-external="1" style="position: relative; z-index:1">
</iframe>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="nest">
  <p>teal is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../analytics.js"></script></footer>
</div>





  </body>
</html>
